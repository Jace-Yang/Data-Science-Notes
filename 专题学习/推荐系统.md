## 基础

典型的推荐系统分为召回和排序层，召回阶段负责将海量的候选集快速缩小为几万到几千的规模；而排序层则负责对缩小后的候选集进行精准排序。

• **召回层：** 待计算的候选集合大、计算速度快、模型简单、特征较少，尽量让用户感兴趣的物品在这个阶段能够被快速召回，即保证相关物品的召回率

• **排序层：** 首要目标是得到精准的排序结果。需要处理的物品数量少，可以利用较多的特征，使用比较复杂的模型

## 协同过滤

协同过滤算法是推荐系统最经典、最常用的算法，基本思想是根据用户之前的喜好以及其他兴趣相近的用户的选择来给用户推荐物品，一般是仅仅基于用户的行为数据, 而不依赖于物品自身特征或者用户的任何附加属性信息。

协同过滤的核心问题是确定用户-物品矩阵，这个矩阵表示用户对不同物品的评分或者是否购买，通常是稀疏的

• 基于用户的协同过滤(UserCF)：给用户推荐和他之前兴趣相似的其他用户喜欢的物品

• 基于物品的系统过滤(ItemCF)：给用户推荐和他之前喜欢的物品相似的物品

相似度度量：

• Jaccard similarity: 两个用户 u 和 v 交互商品交集的数量占这两个用户交互商品并集的数量的比例，无法反映用户评分

• Cosine similarity: 使用cos函数度量两个用户的距离，未评分的项目有误差

• Pearson correlation: 标准化后度量cosine距离

### UserCF

1. 找到和目标用户兴趣相似的集合(Top K)
2. 找到这个集合中的用户喜欢的， 且目标用户没有听说过的物品推荐给目标用户

预测用户i对物品j的评分，选取相似度最高的topK用户对物品的评分做加权平均

此处减去用户k的平均值是考虑到不同用户评分标准不一致的情况
$$
P_{i,j}=\bar R_i + \frac{\sum_{k=1}^{K} S_{i,k}(R_{k,j}-\bar R_k)}{\sum_{k=1}^{K} S_{i,k}}
$$
适用场景：

UserCF在线计算用户之间的相似度，适用于用户少、物品多、时效性强的场合，可能发现用户潜在喜好但自己尚未察觉的物品

### ItemCF

1. 计算物品之间的相似度

2. 根据物品的相似度和用户的历史行为给用户生成推荐列表

$$
P_{i,j}=\bar R_j + \frac{\sum_{k=1}^{K} S_{j,k}(R_{i,k}-\bar R_k)}{\sum_{k=1}^{K} S_{j,k}}
$$

适用场景：

ItemCF离线计算物品相似度矩阵，适用于物品少、用户多、用户兴趣稳定的场合

### 评价指标

用户真实喜好物品集合为$True(u)$，预测用户喜好物品集合为$Pred(u)$

• 召回率：$\frac{|Pred(u)\cap True(u)|}{|True(u)|}$

• 准确率：$\frac{|Pred(u)\cap True(u)|}{|Pred(u)|}$

• 覆盖率：$\frac{|Pred(u)|}{|I|}$预测物品占所有物品的比例

• 新颖度：推荐列表中物品的平均流行度度量推荐结果的新颖度

### 缺陷

泛化能力弱：无法将两个物品相似的信息推广到其他物品的相似性上。 导致热门物品具有很强的头部效应， 容易跟大量物品产生相似， 而尾部物品由于特征向量稀疏， 导致很少被推荐

无外部信息：没有利用到物品本身或者是用户自身的属性， 仅仅利用了用户与物品的交互信息就可以实现推荐，忽略有效信息



两种方法：user-user协同过滤、item-item协同过滤

选择k个最邻近的项目做加权平均

一般item-item方法比user-user方法效果更好

优点：无需选择特征

缺点：冷启动问题、用户矩阵是稀疏的、一些小众项目无法被推荐

4.推荐系统评价方法

误差评估指标：

(1)RMSE，均方根误差

(2)根据项目是否推荐给用户分类为0/1，计算误差率

改进推荐系统的方法

(1)增加数据量

(2)改进模型

其中数据比模型更重要

5.协同过滤算法的改进

通过移动平均的方式改进相似度度量

损失函数定义如下，通过梯度下降法实现参数更新

6.隐变量模型

可能存在过拟合现象，加入L2正则项

使用随机梯度下降法加快收敛速度

## 用户画像

用户画像就是与该用户相关联的数据的可视化的展现，一句话来总结就是用户信息标签化。从用户海量的信息里面去找到一些标签，为用户去贴上这些标签，当然这些标签的来源就是一些用户的行为。

### 作用

（1）精准营销：根据历史用户特征，分析产品的潜在用户和用户的潜在需求，针对特定群体，利用短信、邮件等方式进行营销。

（2）用户统计：根据用户的属性、行为特征对用户进行分类后，统计不同特征下的用户数量、分布；分析不同用户画像群体的分布特征。

（3）数据挖掘：以用户画像为基础构建推荐系统、搜索引擎、广告投放系统，提升服务精准度。

（4）服务产品：对产品进行用户画像，对产品进行受众分析，更透彻地理解用户使用产品的心理动机和行为习惯，完善产品运营，提升服务质量。

（5）行业报告&用户研究：通过用户画像分析可以了解行业动态，比如人群消费习惯、消费偏好分析、不同地域品类消费差异分析

### 数据需求

（1）人口属性：包括性别、年龄等人的基本信息

（2）兴趣特征：浏览内容、收藏内容、阅读咨询、购买物品偏好等

（3）消费特征：与消费相关的特征

（4）位置特征：用户所处城市、所处居住区域、用户移动轨迹等

（5）设备属性：使用的终端特征等

（6）行为数据：访问时间、浏览路径等用户在网站的行为日志数据

（7）社交数据：用户社交相关数据

## 因子分解机FM

普通的线性模型，我们都是将各个特征独立考虑的，并没有考虑到特征与特征之间的相互关系。但实际上，特征之间可能具有一定的关联。 